import time
from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

# chromedriver yolu (senin bilgisayarÄ±ndaki yola gÃ¶re deÄŸiÅŸtir)
chrome_path = r"C:\Users\metin\OneDrive\MasaÃ¼stÃ¼\chromedriver.exe"
service = Service(executable_path=chrome_path)

options = webdriver.ChromeOptions()
options.add_argument("--start-maximized")
browser = webdriver.Chrome(service=service, options=options)

# Instagram giriÅŸ sayfasÄ±nÄ± aÃ§
browser.get("https://www.instagram.com/accounts/login/")

print("ğŸ”‘ LÃ¼tfen giriÅŸ yapÄ±n...")
WebDriverWait(browser, 300).until(
    EC.presence_of_element_located((By.XPATH, "//a[contains(@href, '/accounts/edit/')]"))
)
print("âœ… GiriÅŸ baÅŸarÄ±lÄ±!")

# KullanÄ±cÄ±dan txt dosyasÄ± yolunu al
dosya_yolu = input("ğŸ“‚ KullanÄ±cÄ± listesinin olduÄŸu TXT dosyasÄ±nÄ±n yolunu girin: ")

# TXT dosyasÄ±ndan kullanÄ±cÄ±larÄ± oku
with open(dosya_yolu, "r", encoding="utf-8") as f:
    kullanicilar = [satir.strip() for satir in f.readlines() if satir.strip()]

bekleme_suresi = 5  # Her kullanÄ±cÄ± sonrasÄ± bekleme sÃ¼resi

for kullanici in kullanicilar:
    try:
        profil_url = f"https://www.instagram.com/{kullanici}/"
        browser.get(profil_url)
        print(f"â¡ï¸ {kullanici} profiline gidildi.")

        # Ä°stek GÃ¶nderildi butonuna tÄ±kla
        istek_butonu = WebDriverWait(browser, 5).until(
            EC.element_to_be_clickable(
                (By.XPATH, "//button[contains(@class,'_aswp _aswr _aswv _asw_ _asx2')]//div[@class='_ap3a _aaco _aacw _aad6 _aade'][contains(text(),'Ä°stek GÃ¶nderildi')]")
            )
        )
        istek_butonu.click()
        time.sleep(0.5)

        # AÃ§Ä±lan penceredeki Takibi BÄ±rak butonuna tÄ±kla
        takibi_birak_butonu = WebDriverWait(browser, 5).until(
            EC.element_to_be_clickable((By.XPATH, "//button[contains(text(),'Takibi BÄ±rak')]"))
        )
        takibi_birak_butonu.click()

        print(f"âœ… {kullanici} iÃ§in takip isteÄŸi iptal edildi.")
        time.sleep(bekleme_suresi)

    except Exception:
        print(f"âŒ {kullanici} iÃ§in iÅŸlem yapÄ±lamadÄ± veya 'Ä°stek GÃ¶nderildi' butonu bulunamadÄ±.")
        time.sleep(bekleme_suresi)

print("ğŸ‰ TÃ¼m iÅŸlemler tamamlandÄ±.")
browser.quit()
